# 前端页面设计指导文档

## 概述

本文档指导如何根据 interaqt 应用的后端定义（实体、关系、交互等），系统性地设计前端页面架构和用户交互流程。重点关注页面划分、用户交互点、数据流向等概念层面的设计，而非具体的技术实现。

## 设计原则

### 1. 数据驱动的页面设计
- **以实体为中心**：每个核心实体通常需要对应的管理页面
- **关系决定导航**：实体间的关系决定页面间的跳转和数据关联
- **交互映射功能**：每个 Interaction 应在界面中有对应的操作入口

### 2. 响应式数据展示
- **响应式计算**：所有带 `computedData` 的属性应在界面实时显示
- **状态感知**：根据实体状态动态显示不同的操作选项
- **权限控制**：根据 Attributive 定义控制界面元素的可见性

### 3. 用户体验一致性
- **操作反馈**：每个交互操作都应有明确的反馈
- **状态提示**：清晰显示当前状态和可执行的操作
- **错误处理**：友好的错误提示和恢复指导

---

## 页面设计方法论

### 步骤1：实体分析法

#### 1.1 识别核心实体
从应用定义中提取所有实体，按重要性分类：

**主要实体**：用户直接操作的核心业务对象
- 通常需要完整的 CRUD 页面
- 需要列表页、详情页、创建/编辑页

**辅助实体**：支持业务流程的对象
- 通常以组件形式嵌入到主要实体页面
- 可能只需要简单的管理界面

**系统实体**：框架或系统级别的对象
- 通常不需要独立页面
- 在系统设置或管理后台中处理

#### 1.2 实体页面规划模板

**对于每个主要实体，考虑以下页面：**

```
实体名称: [EntityName]

必需页面：
□ 列表页 ([EntityName]ListPage) - 展示实体集合
□ 详情页 ([EntityName]DetailPage) - 展示单个实体完整信息
□ 创建页 (Create[EntityName]Page) - 创建新实体
□ 编辑页 (Edit[EntityName]Page) - 修改现有实体

可选页面：
□ 搜索页 ([EntityName]SearchPage) - 复杂搜索功能
□ 统计页 ([EntityName]AnalyticsPage) - 数据分析展示
```

### 步骤2：关系导航设计

#### 2.1 关系类型与导航模式

**一对一关系 (1:1)**
- 在主实体页面中嵌入关联实体信息
- 提供快速跳转到关联实体的入口

**一对多关系 (1:n)**
- 在"一"的详情页中显示"多"的列表预览
- 提供"查看全部"链接跳转到过滤后的列表页

**多对多关系 (n:n)**
- 双向导航：两个实体页面都应显示关联信息
- 提供添加/移除关联的操作入口

**对称关系**
- 特殊的多对多关系，注意状态一致性
- 通常用于好友关系、互相关注等场景

#### 2.2 关系导航示例

```
用户(User) 1:n 文章(Post)
├─ 用户详情页：显示该用户的文章列表预览
├─ 文章详情页：显示作者信息，点击跳转用户详情
└─ 用户文章列表页：显示该用户的所有文章

用户(User) n:n 标签(Tag)
├─ 用户详情页：显示用户的标签，支持添加/删除
├─ 标签详情页：显示使用该标签的用户列表
└─ 标签用户列表页：显示该标签的所有用户
```

### 步骤3：交互操作映射

#### 3.1 交互类型与界面位置

**创建类交互**
- 主要位置：专门的创建页面
- 次要位置：列表页的"新建"按钮、快速创建表单

**更新类交互**
- 主要位置：编辑页面、详情页的编辑模式
- 次要位置：列表页的快速编辑、内联编辑

**删除类交互**
- 主要位置：详情页、编辑页的删除按钮
- 次要位置：列表页的批量删除、右键菜单

**查询类交互**
- 主要位置：列表页、搜索页
- 次要位置：筛选组件、搜索框

**业务流程类交互**
- 根据业务逻辑设计专门的操作按钮
- 考虑状态机的状态转换

#### 3.2 交互操作设计模板

```
交互名称: [InteractionName]
操作类型: [Create/Update/Delete/Query/Business]

触发位置：
□ 主要入口：[页面名称 - 具体位置]
□ 次要入口：[页面名称 - 具体位置]

前置条件：
□ 用户权限：[描述权限要求]
□ 数据状态：[描述必要的数据状态]
□ 业务规则：[描述业务约束]

操作流程：
1. [步骤1描述]
2. [步骤2描述]
3. [步骤n描述]

操作结果：
□ 成功反馈：[描述成功后的界面变化]
□ 失败处理：[描述失败时的错误提示]
```

---

## 通用页面模式

### 1. 列表页模式

#### 1.1 基础结构
```
页面标题 + 操作按钮区
├─ 全局操作：新建、批量操作、导入导出
├─ 筛选区：搜索框、筛选器、排序选项
├─ 列表区：数据表格/卡片列表
└─ 分页区：分页控件、显示数量选择
```

#### 1.2 设计要点
- **筛选器设计**：基于实体属性和关系设计筛选条件
- **排序选项**：优先支持时间、热度、名称等常用排序
- **批量操作**：考虑哪些操作适合批量执行
- **状态显示**：根据实体状态显示不同的视觉样式

#### 1.3 响应式数据
- 自动更新列表项的计算属性（如统计数据）
- 实时反映实体状态变化
- 支持列表项的增删改实时更新

### 2. 详情页模式

#### 2.1 基础结构
```
实体基本信息区
├─ 主要属性展示
├─ 响应式计算数据展示
├─ 状态指示器
└─ 主要操作按钮

关联数据区
├─ 一对多关系数据预览
├─ 多对多关系数据展示
└─ 相关操作入口

操作历史区（可选）
├─ 状态变更记录
├─ 操作日志
└─ 审批流程（如适用）
```

#### 2.2 设计要点
- **权限控制**：根据 Attributive 动态显示操作按钮
- **状态感知**：根据实体状态显示不同的操作选项
- **关联展示**：合理展示关联实体，避免信息过载
- **操作反馈**：清晰的操作结果提示

### 3. 创建/编辑页模式

#### 3.1 基础结构
```
表单区
├─ 基本属性输入
├─ 关联数据选择
├─ 可选属性配置
└─ 表单验证提示

预览区（可选）
├─ 实时预览效果
└─ 格式化显示

操作区
├─ 保存、取消按钮
├─ 保存草稿功能（如适用）
└─ 重置表单功能
```

#### 3.2 设计要点
- **表单验证**：基于 PayloadItem 的验证规则
- **关联选择**：提供友好的关联实体选择界面
- **草稿保存**：对于复杂内容提供草稿功能
- **进度保存**：长表单支持分步保存

---

## 特殊功能页面设计

### 1. 工作流页面

当应用包含 Activity 定义时，需要考虑工作流相关页面：

#### 1.1 流程实例页面
- **流程概览**：显示当前状态、进度指示器
- **可执行操作**：根据当前状态显示可用的交互
- **历史记录**：显示状态转换历史和操作记录
- **参与者信息**：显示流程涉及的用户和角色

#### 1.2 任务列表页面
- **待办任务**：需要当前用户处理的任务
- **已完成任务**：用户已处理的任务历史
- **任务筛选**：按流程类型、状态、时间等筛选
- **批量操作**：支持批量审批等操作

### 2. 统计分析页面

对于包含复杂响应式计算的应用：

#### 2.1 数据仪表板
- **关键指标**：展示重要的计算属性数据
- **趋势图表**：显示数据随时间的变化趋势
- **对比分析**：不同维度的数据对比
- **实时更新**：基于响应式计算的实时数据刷新

#### 2.2 报表页面
- **数据导出**：支持各种格式的数据导出
- **自定义报表**：允许用户自定义统计维度
- **定时报表**：自动生成和发送报表功能

### 3. 权限管理页面

对于有复杂权限控制的应用：

#### 3.1 角色管理页面
- **角色定义**：创建和编辑用户角色
- **权限分配**：为角色分配具体权限
- **用户分配**：为用户分配角色

#### 3.2 权限审计页面
- **权限检查**：检查用户对特定资源的权限
- **操作日志**：记录权限相关的操作历史
- **异常监控**：权限异常和安全事件监控

---

## 页面间导航设计

### 1. 导航层次结构

#### 1.1 主导航设计
基于应用的核心实体和功能模块设计主导航：

```
主导航示例：
├─ 首页/仪表板
├─ [主要实体1]管理
├─ [主要实体2]管理
├─ [特殊功能模块]
├─ 设置/配置
└─ 用户中心
```

#### 1.2 面包屑导航
为复杂的页面层次提供面包屑导航：

```
面包屑示例：
首页 > 用户管理 > 用户详情 > 编辑用户
首页 > 内容管理 > 文章列表 > 文章详情
```

### 2. 页面跳转规则

#### 2.1 实体关联跳转
- 从实体A详情页点击关联的实体B，跳转到实体B详情页
- 从实体A列表页点击"查看关联实体B"，跳转到过滤后的实体B列表页

#### 2.2 操作后跳转
- 创建成功后跳转到新建实体的详情页
- 编辑成功后跳转到实体详情页
- 删除成功后跳转到实体列表页

#### 2.3 权限限制跳转
- 无权限访问时跳转到权限提示页
- 登录超时时跳转到登录页
- 需要特定角色时提示申请权限

---

## 响应式数据展示策略

### 1. 实时数据更新

#### 1.1 计算属性展示
对于包含 `computedData` 的属性：
- **实时显示**：在界面上实时显示计算结果
- **变化提示**：数据变化时提供视觉反馈
- **加载状态**：计算进行中时显示加载指示器

#### 1.2 关联数据同步
- **级联更新**：相关实体变化时自动更新显示
- **状态同步**：保持所有相关页面的数据一致性
- **冲突处理**：处理并发修改冲突

### 2. 状态驱动界面

#### 2.1 实体状态显示
- **状态指示器**：清晰显示当前实体状态
- **状态说明**：提供状态含义的说明文字
- **转换提示**：显示可能的状态转换操作

#### 2.2 条件操作显示
基于 Attributive 定义的权限控制：
- **动态按钮**：根据权限动态显示操作按钮
- **禁用状态**：不满足条件时显示禁用的操作
- **权限提示**：解释为什么某个操作不可用

---

## 用户交互流程设计

### 1. 典型交互流程

#### 1.1 创建流程
```
创建新实体流程：
1. 用户在列表页点击"新建"按钮
2. 跳转到创建页面
3. 用户填写必要信息
4. 系统验证数据有效性
5. 调用创建交互
6. 显示创建结果
7. 跳转到新建实体详情页
```

#### 1.2 编辑流程
```
编辑实体流程：
1. 用户在详情页点击"编辑"按钮
2. 页面切换到编辑模式或跳转编辑页
3. 用户修改信息
4. 系统验证修改的数据
5. 调用更新交互
6. 显示更新结果
7. 返回详情页或刷新当前页
```

#### 1.3 关联操作流程
```
建立关联关系流程：
1. 用户在实体A页面发起关联操作
2. 系统显示可关联的实体B列表
3. 用户选择目标实体B
4. 系统调用关联创建交互
5. 显示关联结果
6. 更新相关页面的关联信息显示
```

### 2. 复杂业务流程

#### 2.1 多步骤操作
对于复杂的业务操作：
- **步骤指示器**：显示当前进度和剩余步骤
- **数据保存**：中间步骤支持保存草稿
- **返回修改**：支持返回上一步修改
- **最终确认**：提供操作摘要和最终确认

#### 2.2 审批流程
对于包含审批的业务流程：
- **状态跟踪**：显示审批进度和当前环节
- **操作历史**：显示历史审批意见和操作
- **通知机制**：相关人员的消息通知
- **权限控制**：不同角色看到不同的操作选项

---

## 错误处理和用户反馈

### 1. 错误处理策略

#### 1.1 数据验证错误
- **实时验证**：输入时即时验证并提示
- **提交验证**：提交时统一显示所有错误
- **错误定位**：高亮错误字段并滚动到错误位置
- **修正建议**：提供具体的修正建议

#### 1.2 权限错误
- **友好提示**：用通俗语言解释权限限制
- **解决方案**：提供获取权限的途径
- **联系方式**：提供管理员联系方式
- **替代操作**：推荐用户可以执行的替代操作

#### 1.3 系统错误
- **错误恢复**：提供重试机制
- **状态保存**：保存用户当前的操作状态
- **错误报告**：允许用户反馈错误信息
- **降级方案**：提供基础功能的替代方案

### 2. 操作反馈设计

#### 2.1 即时反馈
- **加载状态**：操作进行中的Loading提示
- **进度显示**：长时间操作的进度条
- **状态变化**：界面元素的即时状态更新
- **音效反馈**：重要操作的声音提示（可选）

#### 2.2 结果反馈
- **成功提示**：操作成功的确认消息
- **失败说明**：操作失败的详细原因
- **影响范围**：说明操作对其他数据的影响
- **后续操作**：建议用户的下一步操作

---

## 设计检查清单

在完成页面设计后，使用以下检查清单验证设计的完整性：

### 1. 实体覆盖检查
- [ ] 每个主要实体都有对应的管理页面
- [ ] 每个实体的CRUD操作都有界面入口
- [ ] 实体间的关系都有导航路径
- [ ] 所有计算属性都在界面中展示

### 2. 交互覆盖检查
- [ ] 每个交互都有对应的界面操作
- [ ] 交互的权限控制在界面中体现
- [ ] 交互的参数在界面中有输入方式
- [ ] 交互的结果在界面中有反馈

### 3. 用户体验检查
- [ ] 用户可以完成所有核心业务流程
- [ ] 页面间的导航路径清晰合理
- [ ] 错误情况有适当的处理和提示
- [ ] 操作反馈及时且明确

### 4. 响应式特性检查
- [ ] 响应式计算的数据能实时更新
- [ ] 相关页面的数据保持同步
- [ ] 状态变化能正确反映在界面上
- [ ] 权限变化能动态更新界面元素

---

## 总结

基于 interaqt 框架的前端页面设计应当：

1. **以数据为中心**：围绕实体和关系设计页面结构
2. **响应式优先**：充分利用框架的响应式计算特性
3. **权限感知**：根据权限控制动态调整界面
4. **状态驱动**：基于实体状态提供相应的操作选项
5. **用户友好**：提供清晰的导航和及时的反馈

通过系统性地分析应用的后端定义，可以设计出既充分利用框架特性，又符合用户使用习惯的前端界面。重点在于理解数据模型和业务逻辑，然后将其转化为直观的用户交互体验。