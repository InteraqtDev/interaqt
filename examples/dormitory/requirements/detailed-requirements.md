# 宿舍管理系统详细需求分析

## 1. 系统概述

### 1.1 系统目标
构建一个完整的宿舍管理系统，支持管理员对宿舍和用户的管理，以及宿舍长对宿舍成员的日常管理。

### 1.2 核心功能
- 宿舍管理员全局管理
- 宿舍创建与配置
- 用户宿舍分配
- 行为评分管理
- 成员踢出流程

## 2. 角色定义

### 2.1 管理员 (Admin)
- 系统最高权限角色
- 可以指定用户为宿舍长
- 可以创建宿舍
- 可以分配用户到宿舍
- 可以审批踢出申请

### 2.2 宿舍长 (DormHead)
- 由管理员指定
- 管理指定宿舍的日常事务
- 可以对宿舍成员进行行为评分
- 可以申请踢出违规成员

### 2.3 普通用户 (Student)
- 系统的基础用户
- 被分配到宿舍的床位
- 接受行为评分
- 可能被踢出宿舍

## 3. 数据模型分析

### 3.1 实体分析
#### 用户 (User)
- 基本信息管理
- 角色分配（管理员/宿舍长/普通用户）
- 宿舍分配状态
- 行为积分记录

#### 宿舍 (Dormitory)
- 宿舍基本信息
- 床位数量配置（4-6个）
- 宿舍长分配
- 成员列表

#### 床位 (Bed)
- 所属宿舍
- 占用状态
- 分配的用户

#### 行为记录 (BehaviorRecord)
- 关联用户
- 扣分原因
- 扣分数量
- 记录时间

#### 踢出申请 (EvictionRequest)
- 申请人（宿舍长）
- 被申请用户
- 申请原因
- 审批状态
- 审批时间

### 3.2 关系分析
- 用户 → 宿舍：多对一关系（一个用户只能在一个宿舍）
- 宿舍 → 床位：一对多关系（一个宿舍有多个床位）
- 用户 → 床位：一对一关系（一个用户占用一个床位）
- 宿舍 → 宿舍长：一对一关系
- 用户 → 行为记录：一对多关系
- 宿舍长 → 踢出申请：一对多关系

## 4. 业务流程分析

### 4.1 宿舍管理流程
1. 管理员登录系统
2. 创建宿舍，设置床位数量（4-6个）
3. 指定宿舍长
4. 分配用户到宿舍的床位

### 4.2 行为评分流程
1. 宿舍长发现用户违规行为
2. 创建行为记录，扣除相应分数
3. 系统更新用户积分
4. 当积分低于阈值时，触发踢出机制

### 4.3 踢出流程
1. 宿舍长发起踢出申请
2. 填写申请原因
3. 管理员收到申请
4. 管理员审批申请
5. 如同意，用户被踢出宿舍
6. 床位释放，可重新分配

## 5. 业务规则细化

### 5.1 宿舍创建规则
- 宿舍床位数量必须在4-6之间
- 宿舍必须有唯一名称
- 创建时必须指定宿舍长

### 5.2 用户分配规则
- 每个用户只能被分配到一个宿舍
- 每个用户只能占用一个床位
- 用户被分配时不能已有宿舍

### 5.3 行为评分规则
- 扣分规则需要可配置
- 需要记录扣分原因和时间
- 积分低于特定阈值（如60分）可申请踢出

### 5.4 踢出申请规则
- 只有宿舍长可以发起申请
- 申请需要管理员审批
- 被踢出用户释放床位
- 踢出记录需要保存

## 6. 权限设计

### 6.1 管理员权限
- 创建、查看、编辑、删除宿舍
- 指定、更换宿舍长
- 分配用户到宿舍
- 审批踢出申请
- 查看所有数据报表

### 6.2 宿舍长权限
- 查看本宿舍信息
- 对本宿舍成员进行评分
- 发起踢出申请
- 查看本宿舍行为记录

### 6.3 普通用户权限
- 查看自己所在宿舍
- 查看自己的积分
- 查看自己的行为记录

## 7. 数据验证需求

### 7.1 输入验证
- 宿舍名称非空且唯一
- 床位数量在4-6之间
- 用户邮箱格式正确
- 扣分原因不能为空

### 7.2 业务验证
- 用户不能重复分配宿舍
- 床位不能重复分配
- 只有宿舍长可以评分
- 积分不足不能申请踢出

## 8. 系统扩展性考虑

### 8.1 规则配置化
- 扣分规则可配置
- 踢出阈值可设置
- 床位数量范围可调整

### 8.2 审批流程
- 支持多级审批
- 审批历史可追溯
- 审批意见记录